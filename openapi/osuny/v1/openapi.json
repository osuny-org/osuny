{
  "openapi": "3.0.1",
  "info": {
    "title": "Osuny",
    "version": "v1"
  },
  "servers": [
    {
      "url": "/api/osuny/v1"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "security": [
    {
      "api_key": []
    }
  ],
  "components": {
    "securitySchemes": {
      "api_key": {
        "type": "apiKey",
        "name": "X-Osuny-Token",
        "in": "header"
      }
    }
  },
  "paths": {
    "/communication/websites/{website_id}/posts": {
      "get": {
        "summary": "Lists a website's posts",
        "tags": [
          "Communication::Website::Post"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "website_id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "examples": {
                  "Successful operation": {
                    "value": [
                      {
                        "id": "03f9a88a-084d-535b-baf7-9008b43969c2",
                        "migration_identifier": "test-post-fixture-1",
                        "localizations": [
                          {
                            "id": "16a1d9cf-f9eb-5ded-914d-dd421b5d395b",
                            "title": "Test",
                            "language": "fr",
                            "published": true,
                            "published_at": "2010-11-28T01:00:00.000+01:00",
                            "created_at": "2024-12-06T10:10:57.523+01:00",
                            "updated_at": "2024-12-06T10:10:57.523+01:00"
                          }
                        ],
                        "created_at": "2024-12-06T10:10:57.538+01:00",
                        "updated_at": "2024-12-06T10:10:57.538+01:00"
                      },
                      {
                        "id": "253a800b-42fe-5586-8114-0c8d6913bbbc",
                        "migration_identifier": null,
                        "localizations": [
                          {
                            "id": "a979b73e-e42b-54de-97d4-df21605e49c0",
                            "title": "Test 2",
                            "language": "fr",
                            "published": true,
                            "published_at": "2010-11-28T01:00:00.000+01:00",
                            "created_at": "2024-12-06T10:10:57.523+01:00",
                            "updated_at": "2024-12-06T10:10:57.523+01:00"
                          }
                        ],
                        "created_at": "2024-12-06T10:10:57.538+01:00",
                        "updated_at": "2024-12-06T10:10:57.538+01:00"
                      },
                      {
                        "id": "f28734c1-0052-554d-a50e-b2356d8c66e4",
                        "migration_identifier": null,
                        "localizations": [
                          {
                            "id": "e60b21c3-5968-54b2-93da-4a6a33fc85cc",
                            "title": "Test 3",
                            "language": "fr",
                            "published": false,
                            "published_at": "2010-11-28T01:00:00.000+01:00",
                            "created_at": "2024-12-06T10:10:57.523+01:00",
                            "updated_at": "2024-12-06T10:10:57.523+01:00"
                          }
                        ],
                        "created_at": "2024-12-06T10:10:57.538+01:00",
                        "updated_at": "2024-12-06T10:10:57.538+01:00"
                      }
                    ]
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "Unauthorized. Please make sure you provide a valid API key.": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Website not found",
            "content": {
              "application/json": {
                "examples": {
                  "Website not found": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Creates a post",
        "tags": [
          "Communication::Website::Post"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "website_id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Successful creation",
            "content": {
              "application/json": {
                "examples": {
                  "Successful creation": {
                    "value": {
                      "id": "109f9e1a-b6d2-4de6-87da-0d64ba91abdb",
                      "migration_identifier": "post-from-api-1",
                      "full_width": false,
                      "localizations": [
                        {
                          "id": "7d1da0e0-55cc-4845-b34d-0533fe05aa69",
                          "migration_identifier": "post-from-api-1-fr",
                          "title": "Ma nouvelle actualité",
                          "language": "fr",
                          "featured_image": {
                            "blob_id": "c3ce8b41-ce7a-4977-a9ef-5d847846796f",
                            "alt": "La lumière brille sur les parois du canyon",
                            "credit": "<p>Photo de <a href=\"https://unsplash.com/fr/@johnnzhou\">John Zhou</a> sur <a href=\"https://unsplash.com/fr/photos/la-lumiere-brille-sur-les-parois-du-canyon-AM-G-Yp5hIk\">Unsplash</a></p>"
                          },
                          "meta_description": "Une nouvelle actualité depuis l'API",
                          "pinned": false,
                          "published": true,
                          "published_at": "2024-11-29T17:49:00.000+01:00",
                          "slug": "ma-nouvelle-actualite",
                          "subtitle": "Une nouvelle actualité",
                          "summary": "<p>Ceci est une nouvelle actualité créée depuis l'API.</p>",
                          "text": null,
                          "created_at": "2024-12-06T10:11:02.729+01:00",
                          "updated_at": "2024-12-06T10:11:02.736+01:00"
                        }
                      ],
                      "website_id": "39d8ed64-c1b7-52d3-9095-025a5742a04f",
                      "created_at": "2024-12-06T10:11:02.721+01:00",
                      "updated_at": "2024-12-06T10:11:02.800+01:00"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Missing migration identifier.",
            "content": {
              "application/json": {
                "examples": {
                  "Missing migration identifier.": {
                    "value": {
                      "error": "Missing migration identifier."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "Unauthorized. Please make sure you provide a valid API key.": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Website not found",
            "content": {
              "application/json": {
                "examples": {
                  "Website not found": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          },
          "422": {
            "description": "Invalid parameters",
            "content": {
              "application/json": {
                "examples": {
                  "Invalid parameters": {
                    "value": {
                      "errors": {
                        "localizations.slug": [
                          "can't be blank",
                          "ne peut contenir que des lettres minuscules, des chiffres et des traits d'union."
                        ],
                        "localizations.title": [
                          "can't be blank"
                        ],
                        "localizations": [
                          "is invalid"
                        ]
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "post": {
                    "type": "object",
                    "properties": {
                      "migration_identifier": {
                        "type": "string",
                        "description": "Unique migration identifier of the post"
                      },
                      "full_width": {
                        "type": "boolean"
                      },
                      "localizations_attributes": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "migration_identifier": {
                              "type": "string",
                              "description": "Unique migration identifier of the localization"
                            },
                            "language": {
                              "type": "string",
                              "description": "ISO 639-1 code of the language",
                              "example": "fr"
                            },
                            "title": {
                              "type": "string"
                            },
                            "featured_image": {
                              "type": "string",
                              "description": "URL of the featured image"
                            },
                            "featured_image_alt": {
                              "type": "string",
                              "description": "Alternative text of the featured image"
                            },
                            "featured_image_credit": {
                              "type": "string",
                              "description": "Credit of the featured image"
                            },
                            "meta_description": {
                              "type": "string"
                            },
                            "pinned": {
                              "type": "boolean"
                            },
                            "published": {
                              "type": "boolean"
                            },
                            "published_at": {
                              "type": "string",
                              "format": "date-time"
                            },
                            "slug": {
                              "type": "string"
                            },
                            "subtitle": {
                              "type": "string"
                            },
                            "summary": {
                              "type": "string"
                            },
                            "text": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "migration_identifier",
                            "language",
                            "title"
                          ]
                        }
                      }
                    },
                    "required": [
                      "migration_identifier",
                      "localizations_attributes"
                    ]
                  }
                },
                "required": [
                  "post"
                ]
              }
            }
          }
        }
      }
    },
    "/communication/websites/{website_id}/posts/{id}": {
      "get": {
        "summary": "Shows a post",
        "tags": [
          "Communication::Website::Post"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "website_id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "description": "Post identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "examples": {
                  "Successful operation": {
                    "value": {
                      "id": "03f9a88a-084d-535b-baf7-9008b43969c2",
                      "migration_identifier": "test-post-fixture-1",
                      "full_width": false,
                      "localizations": [
                        {
                          "id": "16a1d9cf-f9eb-5ded-914d-dd421b5d395b",
                          "migration_identifier": "test-post-fixture-1-fr",
                          "title": "Test",
                          "language": "fr",
                          "meta_description": null,
                          "pinned": null,
                          "published": true,
                          "published_at": "2010-11-28T01:00:00.000+01:00",
                          "slug": "test",
                          "subtitle": null,
                          "summary": null,
                          "text": null,
                          "created_at": "2024-12-06T10:10:57.523+01:00",
                          "updated_at": "2024-12-06T10:10:57.523+01:00"
                        }
                      ],
                      "website_id": "39d8ed64-c1b7-52d3-9095-025a5742a04f",
                      "created_at": "2024-12-06T10:10:57.538+01:00",
                      "updated_at": "2024-12-06T10:10:57.538+01:00"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "Unauthorized. Please make sure you provide a valid API key.": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Post not found",
            "content": {
              "application/json": {
                "examples": {
                  "Website not found": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  },
                  "Post not found": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Updates a post",
        "tags": [
          "Communication::Website::Post"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "website_id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "description": "Post identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful update",
            "content": {
              "application/json": {
                "examples": {
                  "Successful update": {
                    "value": {
                      "id": "03f9a88a-084d-535b-baf7-9008b43969c2",
                      "migration_identifier": "test-post-fixture-1",
                      "full_width": false,
                      "localizations": [
                        {
                          "id": "16a1d9cf-f9eb-5ded-914d-dd421b5d395b",
                          "migration_identifier": "test-post-fixture-1-fr",
                          "title": "Mon nouveau titre",
                          "language": "fr",
                          "meta_description": null,
                          "pinned": null,
                          "published": true,
                          "published_at": "2010-11-28T01:00:00.000+01:00",
                          "slug": "test",
                          "subtitle": null,
                          "summary": null,
                          "text": null,
                          "created_at": "2024-12-06T10:10:57.523+01:00",
                          "updated_at": "2024-12-06T10:11:08.672+01:00"
                        }
                      ],
                      "website_id": "39d8ed64-c1b7-52d3-9095-025a5742a04f",
                      "created_at": "2024-12-06T10:10:57.538+01:00",
                      "updated_at": "2024-12-06T10:11:08.673+01:00"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Missing migration identifier.",
            "content": {
              "application/json": {
                "examples": {
                  "Missing migration identifier.": {
                    "value": {
                      "error": "Missing migration identifier."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "Unauthorized. Please make sure you provide a valid API key.": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Post not found",
            "content": {
              "application/json": {
                "examples": {
                  "Website not found": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  },
                  "Post not found": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          },
          "422": {
            "description": "Invalid parameters",
            "content": {
              "application/json": {
                "examples": {
                  "Invalid parameters": {
                    "value": {
                      "errors": {
                        "localizations.title": [
                          "can't be blank"
                        ],
                        "localizations": [
                          "is invalid"
                        ]
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "post": {
                    "type": "object",
                    "properties": {
                      "migration_identifier": {
                        "type": "string",
                        "description": "Unique migration identifier of the post"
                      },
                      "full_width": {
                        "type": "boolean"
                      },
                      "localizations_attributes": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "migration_identifier": {
                              "type": "string",
                              "description": "Unique migration identifier of the localization"
                            },
                            "language": {
                              "type": "string",
                              "description": "ISO 639-1 code of the language",
                              "example": "fr"
                            },
                            "title": {
                              "type": "string"
                            },
                            "featured_image": {
                              "type": "string",
                              "description": "URL of the featured image"
                            },
                            "featured_image_alt": {
                              "type": "string",
                              "description": "Alternative text of the featured image"
                            },
                            "featured_image_credit": {
                              "type": "string",
                              "description": "Credit of the featured image"
                            },
                            "meta_description": {
                              "type": "string"
                            },
                            "pinned": {
                              "type": "boolean"
                            },
                            "published": {
                              "type": "boolean"
                            },
                            "published_at": {
                              "type": "string",
                              "format": "date-time"
                            },
                            "slug": {
                              "type": "string"
                            },
                            "subtitle": {
                              "type": "string"
                            },
                            "summary": {
                              "type": "string"
                            },
                            "text": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "migration_identifier",
                            "language",
                            "title"
                          ]
                        }
                      }
                    },
                    "required": [
                      "migration_identifier",
                      "localizations_attributes"
                    ]
                  }
                },
                "required": [
                  "post"
                ]
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Deletes a post",
        "tags": [
          "Communication::Website::Post"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "website_id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "description": "Post identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful deletion"
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "Unauthorized. Please make sure you provide a valid API key.": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Post not found",
            "content": {
              "application/json": {
                "examples": {
                  "Website not found": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  },
                  "Post not found": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/communication/websites": {
      "get": {
        "summary": "Lists the websites",
        "tags": [
          "Communication::Website"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "examples": {
                  "Successful operation": {
                    "value": [
                      {
                        "id": "39d8ed64-c1b7-52d3-9095-025a5742a04f",
                        "url": null,
                        "localizations": [
                          {
                            "id": "3d91a284-4159-504e-81c5-6b9b32a08dd7",
                            "name": "Site with github french",
                            "language": "fr",
                            "published": true,
                            "published_at": "2024-11-29T16:07:24.232+01:00",
                            "created_at": "2024-12-06T10:10:57.493+01:00",
                            "updated_at": "2024-12-06T10:10:57.493+01:00"
                          }
                        ]
                      },
                      {
                        "id": "a3f63673-fb05-5751-8634-a2a8bccc1f3d",
                        "url": null,
                        "localizations": [
                          {
                            "id": "b854339d-f776-59c7-af65-e12ee2951daa",
                            "name": "Site with gitlab french",
                            "language": "fr",
                            "published": true,
                            "published_at": "2024-11-29T16:07:24.232+01:00",
                            "created_at": "2024-12-06T10:10:57.493+01:00",
                            "updated_at": "2024-12-06T10:10:57.493+01:00"
                          },
                          {
                            "id": "f55e6093-cf39-525e-b83c-331d90fad1c6",
                            "name": "Site with gitlab english",
                            "language": "en",
                            "published": true,
                            "published_at": "2024-11-29T16:07:24.232+01:00",
                            "created_at": "2024-12-06T10:10:57.493+01:00",
                            "updated_at": "2024-12-06T10:10:57.493+01:00"
                          }
                        ]
                      }
                    ]
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "Unauthorized. Please make sure you provide a valid API key.": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/communication/websites/{id}": {
      "get": {
        "summary": "Shows a website",
        "tags": [
          "Communication::Website"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "examples": {
                  "Successful operation": {
                    "value": {
                      "id": "39d8ed64-c1b7-52d3-9095-025a5742a04f",
                      "name": "Site with github french",
                      "url": null,
                      "deuxfleurs": {
                        "hosting": false,
                        "identifier": null
                      },
                      "features": {
                        "agenda": true,
                        "portfolio": false,
                        "posts": true
                      },
                      "git": {
                        "branch": "main",
                        "endpoint": null,
                        "provider": "github",
                        "repository": "noesya/bordeauxmontaigne-test"
                      },
                      "showcase": {
                        "present": true,
                        "highlighted": false,
                        "tags": []
                      },
                      "localizations": [
                        {
                          "id": "3d91a284-4159-504e-81c5-6b9b32a08dd7",
                          "name": "Site with github french",
                          "language": "fr",
                          "published": true,
                          "published_at": "2024-11-29T16:07:24.232+01:00",
                          "social_email": null,
                          "social_facebook": null,
                          "social_github": null,
                          "social_instagram": null,
                          "social_linkedin": null,
                          "social_mastodon": null,
                          "social_peertube": null,
                          "social_tiktok": null,
                          "social_vimeo": null,
                          "social_x": null,
                          "social_youtube": null,
                          "created_at": "2024-12-06T10:10:57.493+01:00",
                          "updated_at": "2024-12-06T10:10:57.493+01:00"
                        }
                      ],
                      "created_at": "2024-12-06T10:10:57.539+01:00",
                      "updated_at": "2024-12-06T10:10:57.539+01:00"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "Unauthorized. Please make sure you provide a valid API key.": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Website not found",
            "content": {
              "application/json": {
                "examples": {
                  "Website not found": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}