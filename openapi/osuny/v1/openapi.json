{
  "openapi": "3.0.1",
  "info": {
    "title": "Osuny",
    "version": "v1"
  },
  "servers": [
    {
      "url": "/api/osuny/v1"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "security": [
    {
      "api_key": []
    }
  ],
  "components": {
    "securitySchemes": {
      "api_key": {
        "type": "apiKey",
        "name": "X-Osuny-Token",
        "in": "header"
      }
    }
  },
  "paths": {
    "/communication/websites/{website_id}/posts": {
      "get": {
        "summary": "Lists a website's posts",
        "tags": [
          "Communication::Website::Post"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "website_id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": [
                      {
                        "id": "03f9a88a-084d-535b-baf7-9008b43969c2",
                        "migration_identifier": null,
                        "localizations": [
                          {
                            "id": "16a1d9cf-f9eb-5ded-914d-dd421b5d395b",
                            "title": "Test",
                            "language": "fr",
                            "published": true,
                            "published_at": "2010-11-28T01:00:00.000+01:00",
                            "created_at": "2024-12-02T12:25:52.611+01:00",
                            "updated_at": "2024-12-02T12:25:52.611+01:00"
                          }
                        ],
                        "created_at": "2024-12-02T12:25:52.631+01:00",
                        "updated_at": "2024-12-02T12:25:52.631+01:00"
                      },
                      {
                        "id": "253a800b-42fe-5586-8114-0c8d6913bbbc",
                        "migration_identifier": null,
                        "localizations": [
                          {
                            "id": "a979b73e-e42b-54de-97d4-df21605e49c0",
                            "title": "Test 2",
                            "language": "fr",
                            "published": true,
                            "published_at": "2010-11-28T01:00:00.000+01:00",
                            "created_at": "2024-12-02T12:25:52.611+01:00",
                            "updated_at": "2024-12-02T12:25:52.611+01:00"
                          }
                        ],
                        "created_at": "2024-12-02T12:25:52.631+01:00",
                        "updated_at": "2024-12-02T12:25:52.631+01:00"
                      },
                      {
                        "id": "f28734c1-0052-554d-a50e-b2356d8c66e4",
                        "migration_identifier": null,
                        "localizations": [
                          {
                            "id": "e60b21c3-5968-54b2-93da-4a6a33fc85cc",
                            "title": "Test 3",
                            "language": "fr",
                            "published": false,
                            "published_at": "2010-11-28T01:00:00.000+01:00",
                            "created_at": "2024-12-02T12:25:52.611+01:00",
                            "updated_at": "2024-12-02T12:25:52.611+01:00"
                          }
                        ],
                        "created_at": "2024-12-02T12:25:52.631+01:00",
                        "updated_at": "2024-12-02T12:25:52.631+01:00"
                      }
                    ]
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Website not found",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Creates a post",
        "tags": [
          "Communication::Website::Post"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "website_id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Successful creation",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "id": "0faeefca-bd0a-42ec-834b-5ff2abf006bf",
                      "migration_identifier": "post-from-api-1",
                      "full_width": false,
                      "localizations": [
                        {
                          "id": "dc7f805b-9077-4763-a017-2c1ee195c604",
                          "migration_identifier": "post-from-api-1-fr",
                          "title": "Ma nouvelle actualit√©",
                          "language": "fr",
                          "meta_description": null,
                          "pinned": null,
                          "published": null,
                          "published_at": null,
                          "slug": "ma-nouvelle-actualite",
                          "subtitle": null,
                          "summary": null,
                          "text": null,
                          "created_at": "2024-12-02T12:25:53.141+01:00",
                          "updated_at": "2024-12-02T12:25:53.141+01:00"
                        }
                      ],
                      "website_id": "39d8ed64-c1b7-52d3-9095-025a5742a04f",
                      "created_at": "2024-12-02T12:25:53.130+01:00",
                      "updated_at": "2024-12-02T12:25:53.146+01:00"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Missing migration identifier.",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "error": "Missing migration identifier."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Website not found",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          },
          "422": {
            "description": "Invalid parameters",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "localizations.slug": [
                        "can't be blank",
                        "ne peut contenir que des lettres minuscules, des chiffres et des traits d'union."
                      ],
                      "localizations.title": [
                        "can't be blank"
                      ],
                      "localizations": [
                        "is invalid"
                      ]
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "post": {
                    "type": "object",
                    "properties": {
                      "migration_identifier": {
                        "type": "string",
                        "description": "Unique migration identifier of the post"
                      },
                      "full_width": {
                        "type": "boolean"
                      },
                      "localizations_attributes": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "migration_identifier": {
                              "type": "string",
                              "description": "Unique migration identifier of the localization"
                            },
                            "language": {
                              "type": "string",
                              "description": "ISO 639-1 code of the language",
                              "example": "fr"
                            },
                            "title": {
                              "type": "string"
                            },
                            "meta_description": {
                              "type": "string"
                            },
                            "pinned": {
                              "type": "boolean"
                            },
                            "published": {
                              "type": "boolean"
                            },
                            "published_at": {
                              "type": "string",
                              "format": "date-time"
                            },
                            "slug": {
                              "type": "string"
                            },
                            "subtitle": {
                              "type": "string"
                            },
                            "summary": {
                              "type": "string"
                            },
                            "text": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "migration_identifier",
                            "language",
                            "title"
                          ]
                        }
                      }
                    },
                    "required": [
                      "migration_identifier",
                      "localizations_attributes"
                    ]
                  }
                },
                "required": [
                  "post"
                ]
              }
            }
          }
        }
      }
    },
    "/communication/websites/{website_id}/posts/{id}": {
      "get": {
        "summary": "Shows a post",
        "tags": [
          "Communication::Website::Post"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "website_id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "description": "Post identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "id": "03f9a88a-084d-535b-baf7-9008b43969c2",
                      "migration_identifier": null,
                      "full_width": false,
                      "localizations": [
                        {
                          "id": "16a1d9cf-f9eb-5ded-914d-dd421b5d395b",
                          "migration_identifier": null,
                          "title": "Test",
                          "language": "fr",
                          "meta_description": null,
                          "pinned": null,
                          "published": true,
                          "published_at": "2010-11-28T01:00:00.000+01:00",
                          "slug": "test",
                          "subtitle": null,
                          "summary": null,
                          "text": null,
                          "created_at": "2024-12-02T12:25:52.611+01:00",
                          "updated_at": "2024-12-02T12:25:52.611+01:00"
                        }
                      ],
                      "website_id": "39d8ed64-c1b7-52d3-9095-025a5742a04f",
                      "created_at": "2024-12-02T12:25:52.631+01:00",
                      "updated_at": "2024-12-02T12:25:52.631+01:00"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Post not found",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/communication/websites": {
      "get": {
        "summary": "Lists the websites",
        "tags": [
          "Communication::Website"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": [
                      {
                        "id": "39d8ed64-c1b7-52d3-9095-025a5742a04f",
                        "url": null,
                        "localizations": [
                          {
                            "id": "3d91a284-4159-504e-81c5-6b9b32a08dd7",
                            "name": "Site with github french",
                            "language": "fr",
                            "published": true,
                            "published_at": "2024-11-29T16:07:24.232+01:00",
                            "created_at": "2024-12-02T12:25:52.559+01:00",
                            "updated_at": "2024-12-02T12:25:52.559+01:00"
                          }
                        ]
                      },
                      {
                        "id": "a3f63673-fb05-5751-8634-a2a8bccc1f3d",
                        "url": null,
                        "localizations": [
                          {
                            "id": "b854339d-f776-59c7-af65-e12ee2951daa",
                            "name": "Site with gitlab french",
                            "language": "fr",
                            "published": true,
                            "published_at": "2024-11-29T16:07:24.232+01:00",
                            "created_at": "2024-12-02T12:25:52.559+01:00",
                            "updated_at": "2024-12-02T12:25:52.559+01:00"
                          },
                          {
                            "id": "f55e6093-cf39-525e-b83c-331d90fad1c6",
                            "name": "Site with gitlab english",
                            "language": "en",
                            "published": true,
                            "published_at": "2024-11-29T16:07:24.232+01:00",
                            "created_at": "2024-12-02T12:25:52.559+01:00",
                            "updated_at": "2024-12-02T12:25:52.559+01:00"
                          }
                        ]
                      }
                    ]
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/communication/websites/{id}": {
      "get": {
        "summary": "Shows a website",
        "tags": [
          "Communication::Website"
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Website identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "id": "39d8ed64-c1b7-52d3-9095-025a5742a04f",
                      "name": "Site with github french",
                      "url": null,
                      "deuxfleurs": {
                        "hosting": false,
                        "identifier": null
                      },
                      "features": {
                        "agenda": true,
                        "portfolio": false,
                        "posts": true
                      },
                      "git": {
                        "branch": "main",
                        "endpoint": null,
                        "provider": "github",
                        "repository": "noesya/bordeauxmontaigne-test"
                      },
                      "showcase": {
                        "present": true,
                        "highlighted": false,
                        "tags": []
                      },
                      "localizations": [
                        {
                          "id": "3d91a284-4159-504e-81c5-6b9b32a08dd7",
                          "name": "Site with github french",
                          "language": "fr",
                          "published": true,
                          "published_at": "2024-11-29T16:07:24.232+01:00",
                          "social_email": null,
                          "social_facebook": null,
                          "social_github": null,
                          "social_instagram": null,
                          "social_linkedin": null,
                          "social_mastodon": null,
                          "social_peertube": null,
                          "social_tiktok": null,
                          "social_vimeo": null,
                          "social_x": null,
                          "social_youtube": null,
                          "created_at": "2024-12-02T12:25:52.559+01:00",
                          "updated_at": "2024-12-02T12:25:52.559+01:00"
                        }
                      ],
                      "created_at": "2024-12-02T12:25:52.633+01:00",
                      "updated_at": "2024-12-02T12:25:52.633+01:00"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Please make sure you provide a valid API key.",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "message": "You are not authorized to access this resource."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Website not found",
            "content": {
              "application/json": {
                "examples": {
                  "test_example": {
                    "value": {
                      "message": "The resource you were looking for doesn't exist."
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}