<%
program = @l10n.about
language = @l10n.language
teacher_involvements = program.university_person_involvements
                              .includes(:person)
                              .ordered_by_name
administrator_involvements = program.involvements_through_roles
                                   .includes(:person)
                                   .ordered_by_name

%>---
<%= render 'admin/application/static/title', about: @l10n %>
<%= render 'admin/application/static/permalink', about: @l10n %>
<%= render 'admin/application/static/breadcrumbs', about: @l10n %>
<%= render 'admin/application/static/design',
            about: program,
            full_width: false,
            toc_offcanvas: true,
            toc_present: true %>
<% if @l10n.downloadable_summary.attached? %>
downloadable_summary: <%= @l10n.downloadable_summary.blob_id %>
<% end %>
bodyclass: <%= program.bodyclass %>
website_url: >-
  <%= @l10n.url %>
registration_url: >-
  <%= @l10n.registration_url %>
<%= render 'admin/application/meta_description/static', about: @l10n %>
<%= render 'admin/application/summary/static', about: @l10n %>
presentation: >-
  <%= prepare_text_for_static @l10n.presentation %>
position: <%= program.position %>
<% if @l10n.parent %>
parent:
  title: >-
    <%= @l10n.parent.name %>
  url: <%= @l10n.parent.current_permalink_in_website(@website)&.path %>
<% end %>
<%= render 'admin/application/featured_image/static', about: @l10n %>
<%= render 'admin/application/shared_image/static', about: @l10n %>
<% if @l10n.logo.attached? %>
logo:
  id: "<%= @l10n.logo.blob.id %>"
<% end %>
<% if @website %>
related_category: "<%= @website.post_categories
                               .find_by(program_id: program.id)
                               &.slug_with_ancestors_slugs %>"
<% end %>
diplomas: "<%= @l10n.diploma&.slug %>"
duration: >-
  <%= prepare_text_for_static @l10n.duration %>
teachers:
<% teacher_involvements.each do |involvement| %>
  - "<%= involvement.person.slug %>"
<% end %>
teachers_description:
<% teacher_involvements.each do |involvement| %>
  "<%= involvement.person.slug %>": >-
    <%= involvement.description %>
<% end %>
<% if administrator_involvements.any? %>
administrators:
<% administrator_involvements.each do |involvement| %>
  - "<%= involvement.person.slug %>"
<% end %>
administrators_description:
<% administrator_involvements.each do |involvement| %>
  "<%= involvement.person.slug %>": >-
    <%= involvement.target.to_s %>
<% end %>
roles:
<% @about.university_roles.ordered.each do |role| %>
  - title: >-
      <%= role.to_s %>
    persons:
    <% role.involvements.includes(:person).ordered.each do |involvement| %>
      - "<%= involvement.person.slug %>"
    <% end %>
<% end %>
<% else %>
roles: []
<% end %>
locations:
<% program.locations.each do |location| %>
  - path: <%= location.current_permalink_in_website(@website)&.path %>
    slug: <%= location.slug %>
<% end %>
apprenticeship: <%= program.apprenticeship %>
capacity: <%= program.capacity %>
continuing: <%= program.continuing %>
initial: <%= program.initial %>
certifications:
  qualiopi:
    certified: <%= program.qualiopi_certified %>
    text: >-
      <%= prepare_html_for_static @l10n.qualiopi_text %>
<%
[
  :accessibility,
  :contacts,
  :content,
  :evaluation,
  :objectives,
  :opportunities,
  :other,
  :pedagogy,
  :prerequisites,
  :pricing,
  :pricing_initial,
  :pricing_continuing,
  :pricing_apprenticeship,
  :registration,
  :results
].each do |property| %>
<%= property.to_s %>: >-
  <%= prepare_html_for_static @l10n.send("best_#{property}") %>
<% end %>
<%= render 'admin/communication/blocks/content/static', about: @l10n %>
---
